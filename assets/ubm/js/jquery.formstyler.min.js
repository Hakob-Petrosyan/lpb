function getRealOffset(e){if(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/Windows Phone/i)){var t=document.body.getBoundingClientRect(),s=e.get(0).getBoundingClientRect();return{left:s.left-t.left,top:s.top-t.top}}return{left:e.offset().left,top:e.offset().top}}function initStyler(){$("select.styler, input.styler").styler()}$.fn.styler=function(e){var t=void 0!==window.formLang&&void 0!==window.formLang.browse?window.formLang.browse:"�����",s=void 0!==window.formLang&&void 0!==window.formLang.file_not_select?window.formLang.file_not_select:"�������� ����",i=$.extend({wrapper:"form",idSuffix:"-styler",filePlaceholder:t,fileBrowse:s,selectSearch:!0,selectSearchLimit:30,selectSearchLimitWithCheckbox:10,selectSearchNotFound:"���������� �� �������",selectSearchPlaceholder:"�����...",selectVisibleOptions:0,singleSelectzIndex:"1000",selectSmartPositioning:!0,onSelectOpened:function(){},onSelectClosed:function(){},onFormStyled:function(){}},e);return this.each(function(){function e(){var e="",s="",l="",o="";void 0!==t.attr("id")&&""!==t.attr("id")&&(e=' id="'+t.attr("id")+i.idSuffix+'"'),void 0!==t.attr("title")&&""!==t.attr("title")&&(s=' title="'+t.attr("title")+'"'),void 0!==t.attr("class")&&""!==t.attr("class")&&(l=" "+t.attr("class"));for(var n=$.data(t),c=0;c<n.length;c++)""!==n[c]&&(o+=" data-"+c+'="'+n[c]+'"');e+=o,this.id=e,this.title=s,this.classes=l}var t=$(this);if(t.is(":checkbox")){if(t.parent("div.jq-checkbox").length<1){var s=function(){var s=new e,i=$("<div"+s.id+' class="jq-checkbox'+s.classes+'"'+s.title+'><div class="jq-checkbox__div"></div></div>');t.css({position:"absolute",zIndex:"-1",opacity:0,margin:0,padding:0}).after(i).prependTo(i),i.attr("unselectable","on").css({"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","-o-user-select":"none","user-select":"none",display:"inline-block",position:"relative",overflow:"hidden"}),t.is(":checked")&&i.addClass("checked"),t.is(":disabled")&&i.addClass("disabled"),i.bind("click.styler",function(e){return!i.is(".disabled")&&(t.is(":checked")?(t.attr("checked",!1),i.removeClass("checked")):(t.attr("checked",!0),i.addClass("checked")),t.change(),!1)}),t.closest("label").add('label[for="'+t.attr("id")+'"]').click(function(e){if(e.preventDefault(),"A"==e.target.tagName&&$(e.target).attr("href")&&void 0!==$(e.target).attr("href"))return window.location.href=$(e.target).attr("href"),!0;i.click()}),t.bind("change.styler",function(){t.is(":checked")?i.addClass("checked"):i.removeClass("checked")}).bind("keydown.styler",function(e){32==e.which&&i.click()}).bind("focus.styler",function(){i.is(".disabled")||i.addClass("focused")}).bind("blur.styler",function(){i.removeClass("focused")})};s(),t.bind("refresh",function(){t.unbind(".styler").parent().before(t).remove(),s()})}}else if(t.is(":radio")){if(t.parent("div.jq-radio").length<1){var l=function(){var s=new e,l=$("<div"+s.id+' class="jq-radio'+s.classes+'"'+s.title+'><div class="jq-radio__div"></div></div>');t.css({position:"absolute",zIndex:"-1",opacity:0,margin:0,padding:0}).after(l).prependTo(l),l.attr("unselectable","on").css({"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","-o-user-select":"none","user-select":"none",display:"inline-block",position:"relative"}),t.is(":checked")&&l.addClass("checked"),t.is(":disabled")&&l.addClass("disabled"),l.bind("click.styler",function(){return!l.is(".disabled")&&!l.find("input:radio").is(":checked")&&(l.closest(i.wrapper).find('input[name="'+t.attr("name")+'"]').attr("checked",!1).parent().removeClass("checked"),t.attr("checked",!0).parent().addClass("checked"),t.change(),!1)}),t.closest("label").add('label[for="'+t.attr("id")+'"]').click(function(e){l.click(),e.preventDefault()}),t.bind("change.styler",function(){t.parent().addClass("checked")}).bind("focus.styler",function(){l.is(".disabled")||l.addClass("focused")}).bind("blur.styler",function(){l.removeClass("focused")})};l(),t.bind("refresh",function(){t.unbind(".styler").parent().before(t).remove(),l()})}}else if(t.is(":file"))t.css({position:"absolute",top:0,right:0,width:"100%",height:"100%",opacity:0,margin:0,padding:0}).each(function(){if(t.parent("div.jq-file").length<1){var s=function(){var s=new e,l=$("<div"+s.id+' class="jq-file'+s.classes+'"'+s.title+' style="display: inline-block; position: relative; overflow: hidden"></div>'),o=$('<div class="jq-file__name">'+i.filePlaceholder+"</div>").appendTo(l);$('<div class="jq-file__browse">'+i.fileBrowse+"</div>").appendTo(l);t.after(l),l.append(t),t.is(":disabled")&&l.addClass("disabled"),t.bind("change.styler",function(){var e=t.val();if(t.is("[multiple]")){e="";for(var s=t[0].files,n=0;n<s.length;n++)e+=(n>0?", ":"")+s[n].name}o.text(e.replace(/.+[\\\/]/,"")),""===e?(o.text(i.filePlaceholder),l.removeClass("changed")):l.addClass("changed")}).bind("focus.styler",function(){l.addClass("focused")}).bind("blur.styler",function(){l.removeClass("focused")}).bind("click.styler",function(){l.removeClass("focused")})};s(),t.bind("refresh",function(){t.unbind(".styler").parent().before(t).remove(),s()})}});else if(t.is("select")){if(t.parent("div.jqselect").length<1){var o=function(){function s(e){e.unbind("mousewheel DOMMouseScroll").bind("mousewheel DOMMouseScroll",function(e){var t=null;"mousewheel"==e.type?t=-1*e.originalEvent.wheelDelta:"DOMMouseScroll"==e.type&&(t=40*e.originalEvent.detail),t&&(e.stopPropagation(),e.preventDefault(),$(this).scrollTop(t+$(this).scrollTop()))})}function l(){for(var e=0;e<n.length;e++){var s=n.eq(e),l="",o="",d="",a="",r="",h="",f="",u="",p="",v="";s.prop("selected")&&(o="selected sel",v=" checked"),s.is(":disabled")&&(o="disabled"),s.is(":selected:disabled")&&(o="selected sel disabled"),void 0!==s.attr("id")&&""!==s.attr("id")&&(a=' id="'+s.attr("id")+i.idSuffix+'"'),void 0!==s.attr("title")&&""!==n.attr("title")&&(r=' title="'+s.attr("title")+'"'),void 0!==s.attr("class")&&(f=" "+s.attr("class"),p=' data-jqfs-class="'+s.attr("class")+'"');var g=s.data();for(var b in g)""!==g[b]&&(h+=" data-"+b+'="'+g[b]+'"');o+f!==""&&(d=' class="'+o+f+'"'),l=t.is("[data-custom-multiple]")?"<li"+p+h+d+r+a+">"+('<div class="jq-selectbox__multiple-item"><input type="checkbox" class="styler"'+v+"><span>"+s.html()+"</span></div>")+"</li>":"<li"+p+h+d+r+a+">"+s.html()+"</li>",s.parent().is("optgroup")&&(void 0!==s.parent().attr("class")&&(u=" "+s.parent().attr("class")),l="<li"+p+h+' class="'+o+f+" option"+u+'"'+r+a+">"+s.html()+"</li>",s.is(":first-child")&&(l='<li class="optgroup'+u+'">'+s.parent().attr("label")+"</li>"+l)),c+=l}}function o(o){function d(){var e=[];$.each(n.filter(":selected"),function(){e.push($(this).text())}),e.length?e.length>3?f.html(e.slice(0,3).join(", ")+", ..."):f.html(e.join(", ")):f.html(t.data("title"))}(o=o||!1)&&(i.selectSearch=!0,i.selectSearchLimit=i.selectSearchLimitWithCheckbox);var a=new e,r=$("<div"+a.id+' class="jq-selectbox jqselect'+a.classes+'" style="display: inline-block; position: relative; z-index:'+i.singleSelectzIndex+'"><div class="jq-selectbox__select"'+a.title+' style="position: relative"><div class="jq-selectbox__select-text"></div><div class="jq-selectbox__trigger"><div class="jq-selectbox__trigger-arrow"></div></div></div></div>');t.css({margin:0,padding:0}).after(r).prependTo(r);var h=$("div.jq-selectbox__select",r),f=$("div.jq-selectbox__select-text",r),u=n.filter(":selected");u.length?f.html(u.text()):f.html(n.filter(":first").text()),l();var p="";i.selectSearch&&(p='<div class="jq-selectbox__search"><input type="search" autocomplete="off" placeholder="'+i.selectSearchPlaceholder+'"></div><div class="jq-selectbox__not-found">'+i.selectSearchNotFound+"</div>");var v=$('<div class="jq-selectbox__dropdown" style="position: absolute">'+p+'<ul style="position: relative; list-style: none; overflow: auto; overflow-x: hidden">'+c+"</ul></div>");$("body").append(v);var g=$("ul",v),b=$("li",v),m=$("input",v),x=$("div.jq-selectbox__not-found",v).hide();b.length<i.selectSearchLimit&&m.parent().hide();var w=0,y=0;b.each(function(){var e=$(this);e.innerWidth()>w&&(w=e.innerWidth(),y=e.width()+20)});var C=r.clone().appendTo("body").width("auto"),k=C.width();C.remove(),k==r.width()&&(f.width(y),w+=r.find("div.jq-selectbox__trigger").width()),w>r.width()&&v.width(w),t.css({position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:0});var q=r.outerHeight(),j=m.outerHeight(),_=g.css("max-height"),S=b.filter(".selected");S.length<1&&!o&&b.filter(":first").addClass("selected sel"),void 0===b.data("li-height")&&b.data("li-height",b.outerHeight());v.css("top");if("auto"==v.css("left")&&v.css({left:0}),"auto"==v.css("top")&&v.css({top:q}),v.hide(),S.length&&(n.filter(":first").text()!=u.text()&&r.addClass("changed"),r.data("jqfs-class",S.data("jqfs-class")),r.addClass(S.data("jqfs-class"))),t.is(":disabled"))return r.addClass("disabled"),!1;h.click(function(){if($("div.jq-selectbox").filter(".opened").length&&i.onSelectClosed.call($("div.jq-selectbox").filter(".opened")),t.focus(),!!!navigator.userAgent.match(/(iPad|iPhone|iPod)/g)){var e=$(window),l=b.data("li-height"),o=r.offset().top,n=e.height()-q-(o-e.scrollTop()),c=i.selectVisibleOptions,d=5*l,a=l*c;c>0&&c<6&&(d=a),0===c&&(a="auto");var h=getRealOffset(r),f=function(){x.hide();var e=function(){g.css("max-height",Math.floor((n-20-j)/l)*l-l)};e(),$.browser.msie||g.css("max-height",a),"none"!=_&&g.css("max-height",_),n<v.outerHeight()+40&&e(),v.css({width:r.width()+"px",left:h.left+"px",top:h.top+r.height()+"px","z-index":2e3})};return!0===i.selectSmartPositioning?n>d+j+20?f():function(){x.hide();var t=function(){g.css("max-height",Math.floor((o-e.scrollTop()-20-j)/l)*l)};t(),$.browser.msie||g.css("max-height",a),"none"!=_&&g.css("max-height",_),o-e.scrollTop()-20<v.outerHeight()+20&&t(),v.css({width:r.width()+"px",left:h.left+"px",top:h.top-v.outerHeight()+"px",bottom:"auto","z-index":2e3,height:"auto"})}():!1===i.selectSmartPositioning&&n>d+j+20&&f(),$("div.jqselect").css({zIndex:i.singleSelectzIndex-1}).removeClass("opened"),r.css({zIndex:i.singleSelectzIndex}),v.is(":hidden")?($("div.jq-selectbox__dropdown:visible").hide(),v.show(),r.addClass("opened focused"),i.onSelectOpened.call(r)):(v.hide(),r.removeClass("opened"),$("div.jq-selectbox").filter(".opened").length&&i.onSelectClosed.call(r)),b.filter(".selected").length&&(g.innerHeight()/l%2!=0&&(l/=2),g.scrollTop(g.scrollTop()+b.filter(".selected").position().top-g.innerHeight()/2+l)),m.length&&(m.val("").keyup(),x.hide(),m.keyup(function(){var e=$(this).val();b.each(function(){$(this).html().match(new RegExp(".*?"+e+".*?","i"))?$(this).show():$(this).hide()}),b.filter(":visible").length<1?x.show():x.hide()})),s(g),!1}}),b.hover(function(){$(this).siblings().removeClass("selected")});var T=b.filter(".selected").text();b.filter(".selected").text();b.filter(":not(.disabled):not(.optgroup)").click(function(){t.focus();var e=$(this),s=e.text();if(!e.is(".selected")){var l=b.index(e);l-=e.prevAll(".optgroup").length,e.addClass("selected sel").siblings().removeClass("selected sel"),n.attr("selected",!1).eq(l).attr("selected",!0),T=s,f.html(s),r.data("jqfs-class")&&r.removeClass(r.data("jqfs-class")),r.data("jqfs-class",e.data("jqfs-class")),r.addClass(e.data("jqfs-class")),t.change()}m.length&&(m.val("").keyup(),x.hide()),v.hide(),r.removeClass("opened"),i.onSelectClosed.call(r)}),v.mouseout(function(){$("li.sel",v).addClass("selected")}),t.bind("change.styler",function(){f.html(n.filter(":selected").text()),b.removeClass("selected sel").not(".optgroup").eq(t[0].selectedIndex).addClass("selected sel"),n.filter(":first").text()!=b.filter(".selected").text()?r.addClass("changed"):r.removeClass("changed")}).bind("focus.styler",function(){r.addClass("focused"),$("div.jqselect").not(".focused").removeClass("opened")}).bind("blur.styler",function(){r.removeClass("focused")}).bind("keydown.styler keyup.styler",function(e){var s=b.data("li-height");f.html(n.filter(":selected").text()),b.removeClass("selected sel").not(".optgroup").eq(t[0].selectedIndex).addClass("selected sel"),38!=e.which&&37!=e.which&&33!=e.which&&36!=e.which||g.scrollTop(g.scrollTop()+b.filter(".selected").position().top),40!=e.which&&39!=e.which&&34!=e.which&&35!=e.which||g.scrollTop(g.scrollTop()+b.filter(".selected").position().top-g.innerHeight()+s),32==e.which&&e.preventDefault(),13==e.which&&(e.preventDefault(),v.hide(),r.removeClass("opened"),i.onSelectClosed.call(r))}),$(document).bind("click",function(e){$(e.target).parents().hasClass("jq-selectbox__dropdown")||"OPTION"==e.target.nodeName||($("div.jq-selectbox").filter(".opened").length&&i.onSelectClosed.call($("div.jq-selectbox").filter(".opened")),m.length&&m.val("").keyup(),v.hide().find("li.sel").addClass("selected"),r.removeClass("focused opened"))}),o&&(d(),v.unbind("mouseout"),b.unbind("hover"),t.unbind("change.styler"),t.bind("change.styler",function(e){b.removeClass("selected sel"),$.each(n.filter(":selected"),function(){b.not(".optgroup").eq($(this).index()).addClass("selected sel")}),d()}),r.on("keydown keyup",function(){return!1}),t.unbind("keydown.styler keyup.styler"),b.filter(":not(.disabled):not(.optgroup)").unbind("click"),b.filter(":not(.disabled):not(.optgroup)").click(function(e,s){e.stopPropagation(),t.focus();var l=$(this),o=(l.text(),l.find("input:checkbox")),c=b.index(l);c-=l.prevAll(".optgroup").length,void 0===s&&(o.is(":checked")?l.find("input:checkbox").removeAttr("checked").trigger("refresh"):l.find("input:checkbox").attr("checked",!0).trigger("refresh")),o.is(":checked")?(n.eq(c).attr("selected",!0),r.data("jqfs-class")&&r.removeClass(r.data("jqfs-class")),r.data("jqfs-class",l.data("jqfs-class")),r.addClass(l.data("jqfs-class"))):n.eq(c).attr("selected",!1),t.change(),m.length&&(m.val("").keyup(),x.hide()),i.onSelectClosed.call(r)}),b.find("input:checkbox").on("change",function(e){e.stopPropagation(),$(this).closest("li").trigger("click",["checkbox"])}))}var n=$("option",t),c="";t.is("[data-custom-multiple]")?o(!0):t.is("[multiple]")?function(){var i=new e,o=$("<div"+i.id+' class="jq-select-multiple jqselect'+i.classes+'"'+i.title+' style="display: inline-block; position: relative"></div>');t.css({margin:0,padding:0}).after(o),l(),o.append("<ul>"+c+"</ul>");var d=$("ul",o).css({position:"relative","overflow-x":"hidden","-webkit-overflow-scrolling":"touch"}),a=$("li",o).attr("unselectable","on").css({"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","-o-user-select":"none","user-select":"none"}),r=t.attr("size"),h=d.outerHeight(),f=a.outerHeight();a.height()<=0&&(f=25),void 0!==r&&r>0?d.css({height:f*r}):d.css({height:4*f}),h>o.height()&&(d.css("overflowY","scroll"),s(d),a.filter(".selected").length&&d.scrollTop(d.scrollTop()+a.filter(".selected").position().top)),t.prependTo(o).css({position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:0}),t.is(":disabled")?(o.addClass("disabled"),n.each(function(){$(this).is(":selected")&&a.eq($(this).index()).addClass("selected")})):(a.filter(":not(.disabled):not(.optgroup)").click(function(e){t.focus();var s=$(this);if(e.ctrlKey||e.metaKey||s.addClass("selected"),e.shiftKey||s.addClass("first"),e.ctrlKey||e.metaKey||e.shiftKey||s.siblings().removeClass("selected first"),(e.ctrlKey||e.metaKey)&&(s.is(".selected")?s.removeClass("selected first"):s.addClass("selected first"),s.siblings().removeClass("first")),e.shiftKey){var i=!1,l=!1;s.siblings().removeClass("selected").siblings(".first").addClass("selected"),s.prevAll().each(function(){$(this).is(".first")&&(i=!0)}),s.nextAll().each(function(){$(this).is(".first")&&(l=!0)}),i&&s.prevAll().each(function(){if($(this).is(".selected"))return!1;$(this).not(".disabled, .optgroup").addClass("selected")}),l&&s.nextAll().each(function(){if($(this).is(".selected"))return!1;$(this).not(".disabled, .optgroup").addClass("selected")}),1==a.filter(".selected").length&&s.addClass("first")}n.attr("selected",!1),a.filter(".selected").each(function(){var e=$(this),t=a.index(e);e.is(".option")&&(t-=e.prevAll(".optgroup").length),n.eq(t).attr("selected",!0)}),t.change()}),n.each(function(e){$(this).data("optionIndex",e)}),t.bind("change.styler",function(){a.removeClass("selected");var e=[];n.filter(":selected").each(function(){e.push($(this).data("optionIndex"))}),a.not(".optgroup").filter(function(t){return $.inArray(t,e)>-1}).addClass("selected")}).bind("focus.styler",function(){o.addClass("focused")}).bind("blur.styler",function(){o.removeClass("focused")}),h>o.height()&&t.bind("keydown.styler",function(e){0!=a.filter(".selected:last").length&&(38!=e.which&&37!=e.which&&33!=e.which||d.scrollTop(d.scrollTop()+a.filter(".selected").position().top-f),40!=e.which&&39!=e.which&&34!=e.which||d.scrollTop(d.scrollTop()+a.filter(".selected:last").position().top-d.innerHeight()+2*f))}))}():o()};o(),t.bind("refresh",function(){t.unbind(".styler").parent().before(t).remove(),o()})}}else t.is(":reset")&&t.bind("click",function(){setTimeout(function(){t.closest(i.wrapper).find("input, select").trigger("refresh")},1)});$(window).resize(function(){$("div.jq-selectbox").filter(".opened").length&&i.onSelectClosed.call($("div.jq-selectbox").filter(".opened")),$(".jq-selectbox__search input").length&&$(".jq-selectbox__search input").val().length&&$(".jq-selectbox__search input").val("").keyup(),$(".jq-selectbox__dropdown").hide().find("li.sel").addClass("selected"),$(".jq-selectbox").removeClass("focused opened")})})},$(function(){initStyler()});